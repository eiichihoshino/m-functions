addpath(genpath('.'));filelist_by_id = get_filelist_by_id(merged_file_path);[m, n] = size(filelist_by_id);summary = cell(m, (n-1)*2+4);summary(:, 1) = filelist_by_id(:,1);for id_i = 1:size(filelist_by_id,1)    fprintf('Processing: %d out of %d.\n', id_i, size(filelist_by_id, 1));        do_files_exist = cell2mat(cellfun(@(x) exist(x, 'file'), filelist_by_id(id_i,:), 'UniformOutput', false));    files = filelist_by_id(id_i, do_files_exist>0);        clear wss;    for mes_i = length(files):-1:1        load(files{mes_i});        wss(mes_i) = ws;    end    lengths0 = arrayfun(@(x) size(x.data0, 1), wss);    lengths = arrayfun(@(x) size(x.data, 1), wss);    durations = reshape([lengths0; lengths;], [1 length(wss)*2]);    summary(id_i, 2:numel(durations)+1) = num2cell(durations);    [~, max_i] = max(lengths);    clear ws;    ws = wss(max_i);    is_sample_long = ws.connectivity.n(:,:,1) >= 1200;    not_nan = ~isnan(ws.connectivity.r(:,:,1));    number_of_valid_channel_pairs = sum(sum(triu(is_sample_long & not_nan, 1)));    summary(id_i, (n-1)*2+2:end) = num2cell([...        max_i ...        number_of_valid_channel_pairs ...        number_of_valid_channel_pairs >= total_number_of_pairs * (1-0.75) ...        ]);    endheader = ['SubjectID'...,reshape([arrayfun(@(d) ['Day' num2str(d) 'Duration'], 1:(n-1), 'UniformOutput', false);arrayfun(@(d) ['Day' num2str(d) 'DurationWithoutArtifact'], 1:(n-1), 'UniformOutput', false);], [1 (n-1)*2])...,'LongestDay', 'NumberOfValidChPairs', 'IsSubjectValid'];summary = [header; summary;];cell2csv(summary, 'summary.csv');fprintf('Fin.\n');